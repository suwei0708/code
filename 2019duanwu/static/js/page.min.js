function initPageEvents(){document.body.addEventListener("touchmove",bodyScroll,{passive:!1});var a=+$(".qj-chuan").offset().top;$(".p1-msg3, .p1-hand").on("click",function(){$(".page-start").show(),app.audio.src=app.mxuanwo,app.audio.play(),app.music.play(),setTimeout(function(){$(".page-start").fadeOut(),$(".page1").hide(),$(".page-noswiper").show(),document.body.removeEventListener("touchmove",bodyScroll,{passive:!1}),$(".page2").fadeIn(400,function(){a=+$(".qj-chuan").offset().top,$(".qj-hand").show(),$(".qj-drop").animate({left:"-10px"},1500,function(){$(".qj-drop").fadeOut(400,function(){app.audio.src=app.mmijing,app.audio.play(),$(".qj-chuan").addClass("a-chuan"),$(".page-noswiper").hide()})})})},500)}),$(".scroll").on("scroll",function(){$(".qj-hand").fadeOut(1e3);var p=$(".scroll").scrollTop();$(".qj-chuan").css({top:p+a}),p>=12100?app.audio.src.match(/2019duanwu\/(\S*)/)[1]!=app.mlongzhou?(app.audio.src=app.mlongzhou,app.audio.play()):app.audio.pause&&app.audio.play():p>=10530&&p<11800?app.audio.src.match(/2019duanwu\/(\S*)/)[1]!=app.mzongzi?(app.audio.src=app.mzongzi,app.audio.play()):app.audio.pause&&app.audio.play():p>=8200&&p<9e3?app.audio.src.match(/2019duanwu\/(\S*)/)[1]!=app.mzhiyuan?(app.audio.src=app.mzhiyuan,app.audio.play()):app.audio.pause&&app.audio.play():p>=5300&&p<6720?app.audio.src.match(/2019duanwu\/(\S*)/)[1]!=app.mxiangnang?(app.audio.src=app.mxiangnang,app.audio.play()):app.audio.pause&&app.audio.play():p>=3530&&p<5070?app.audio.src.match(/2019duanwu\/(\S*)/)[1]!=app.maicao?(app.audio.src=app.maicao,app.audio.play()):app.audio.pause&&app.audio.play():p<1530?app.audio.src.match(/2019duanwu\/(\S*)/)[1]!=app.mmijing?(app.audio.src=app.mmijing,app.audio.play()):app.audio.pause&&app.audio.play():app.audio.pause()}),$(".btn-duanwu").on("click",function(){$(".page2").hide(),$(".page3").fadeIn()}),$(".btn-tongyi").on("click",function(){document.body.addEventListener("touchmove",bodyScroll,{passive:!1}),$(".page3").hide(),$(".page4").fadeIn()}),$(".btn-tslx").on("click",function(){$(".page4").hide(),$(".page5").fadeIn()}),$(".btn-fanhui").on("click",function(){$(".page5").hide(),$(".page4").fadeIn()}),$(".dot").on("click",function(){$(this).prev(".tips").fadeIn()}),$(".tips").on("click",function(){$(this).fadeOut()}),$(".tips-an").on("touchstart",function(){return $(this).hide(),!1}),$(".tips-an").on("click",function(){return $(this).hide(),!1}),$(".btn-yulan").on("click",function(){return!!isClick&&($.trim($("#form input[name=impression]:checked").val())?$.trim($("#form input[name=name]").val())?$.trim($("#form input[name=mobile]").val())?/^1\d{10}$/.test($.trim($("#form input[name=mobile]").val()))?$.trim($("#form select[name=date] option:selected").val())?(isClick=0,$(".spinner-box").show(),$("#ringoImage").attr("src","./static/img/haibao"+$("#form input[name = impression]:checked").val()+".jpg "),void setTimeout(function(){var a=document.getElementById("ringoImage"),p=document.getElementById("ecode"),e=$.trim($("#form input[name=name]").val()),i=$.trim($("#form select[name=date] option:selected").val()),n=convertImageToCanvas(a,p,e,i);document.getElementById("canvasHolder").appendChild(n),document.getElementById("pngHolder").appendChild(convertCanvasToImage(n)),$(".tips-an").show(),$(".page6").fadeIn(),$(".spinner-box, .page4").hide(),isClick=1},500)):(alertTips("日期不能为空！"),!1):(alertTips("电话号码格式不正确"),!1):(alertTips("电话号码不能为空！"),!1):(alertTips("姓名不能为空！"),!1):(alertTips("请选择端午印象！"),!1))}),$(".btn-tijiao").on("click",function(){return!!isClick&&($.trim($("#form input[name=impression]:checked").val())?$.trim($("#form input[name=name]").val())?$.trim($("#form input[name=mobile]").val())?/^1\d{10}$/.test($.trim($("#form input[name=mobile]").val()))?$.trim($("#form select[name=date] option:selected").val())?(isClick=0,$(".spinner-box").show(),$.ajax({url:"https://m.xinliling.com/trees?type=4",type:"POST",dataType:"json",data:$("#form").serialize()}).done(function(a){alertTips("报名成功！")}).fail(function(a){422==a.status?alertTips(a.responseText):alertTips("网络错误，请稍后重试")}).always(function(){isClick=1,$(".spinner-box").hide()}),!1):(alertTips("日期不能为空！"),!1):(alertTips("电话号码格式不正确"),!1):(alertTips("电话号码不能为空！"),!1):(alertTips("姓名不能为空！"),!1):(alertTips("请选择端午印象！"),!1))}),$(".page6").on("click",function(){$(this).hide(),$(".page4").show()}),document.body.addEventListener("focusout",()=>{setTimeout(()=>{console.log(111);var a=document.documentElement.scrollTop||document.body.scrollTop||0;window.scrollTo(0,Math.max(a-1,0))},100)})}function convertImageToCanvas(a,p,e,i){var n=document.createElement("canvas");n.width=a.width,n.height=a.height;var t=n.getContext("2d");return t.save(),t.drawImage(a,0,0,750,1334),t.drawImage(p,55,1183,110,110),t.fillStyle="#000",t.font="29px Microsoft Yahei",t.fillText(e,320,1085),t.font="22px Microsoft Yahei",t.fillText("报名"+i+"时间， 端午假， 自驾去汨罗",241,1303),t.restore(),t.stroke(),n}function convertCanvasToImage(a){var p=new Image;return p.crossOrigin="anonymous",p.src=a.toDataURL("image/png"),p}function bodyScroll(a){a.preventDefault()}function alertTips(a,p){$(".alerttips-box").length||($("#content").append('<div class="alerttips-box"><div class="alerttips"></div></div>'),$("body").append()),$(".alerttips").html(a),$(".alerttips-box").show(),time=p||2e3,clearTimeout(alertTimes),alertTimes=setTimeout(function(){$(".alerttips-box").hide()},time)}var app={},resultNum=0,isClick=1;app.width,app.height,app.loop=!1,app.DEFAULT_WIDTH=750,app.DEFAULT_HEIGHT=1334,app.baseUrl="static/img/",app.music=$("#bg")[0],app.audio=$("#audio")[0],app.mxuanwo="static/music/xuanwo.mp3",app.mmijing="static/music/mijing.mp3",app.maicao="static/music/aicao.mp3",app.mxiangnang="static/music/xiangnang.mp3",app.mzhiyuan="static/music/zhiyuan.mp3",app.mzongzi="static/music/zongzi.mp3",app.mlongzhou="static/music/longzhou.mp3",app.init=function(){app.audio&&app.audio.play(),document.addEventListener("WeixinJSBridgeReady",function(){app.audio.play()},!1);var a=[app.baseUrl+"a-loading.png",app.baseUrl+"start.png",app.baseUrl+"a-chuan.png",app.baseUrl+"a-gu.png",app.baseUrl+"a-laoren.png",app.baseUrl+"a-xiangnang.png",app.baseUrl+"a-zongzi.png",app.baseUrl+"a-fengzheng1.png",app.baseUrl+"a-fengzheng2.png",app.baseUrl+"a-fengzheng3.png",app.baseUrl+"a-longzhou.png",app.baseUrl+"haibao1.jpg",app.baseUrl+"haibao2.jpg",app.baseUrl+"haibao3.jpg",app.baseUrl+"haibao4.jpg",app.baseUrl+"haibao5.jpg"];$.each($("#content img"),function(){a.push($(this).attr("src"))}),$.imgpreload(a,{all:function(){setTimeout(function(){$(".loading").fadeOut(),$(".page1").show(),app.audio&&app.audio.play(),document.addEventListener("WeixinJSBridgeReady",function(){app.audio.play()},!1),$(".page1").find(".p1-msg1").fadeIn(400,function(){$(".page1").find(".p1-msg1").delay(1500).fadeOut(),$(".page1").find(".p1-msg2").delay(1500).fadeIn(400,function(){$(".page1").find(".p1-msg2").delay(1e3).fadeOut(),$(".page1").find(".p1-msg3").delay(1e3).fadeIn(400,function(){$(".page1").find(".p1-bq").addClass("cur"),$(".page1").find(".p1-hand").delay(500).fadeIn(500,function(){app.audio.pause()})})})})},500)}})},$(function(){app.init(),initPageEvents()});var alertTimes,result=[];